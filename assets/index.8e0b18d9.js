var C=Object.defineProperty;var E=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var S=(e,t,n)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))T.call(t,n)&&S(e,n,t[n]);if(E)for(var n of E(t))O.call(t,n)&&S(e,n,t[n]);return e};import{d as p,c as f,r as v,w as k,a,b as R,v as w,n as L,e as I,f as V,g as P}from"./vendor.e75d58ac.js";const $=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};$();const A=(e,t="singleProvide")=>{const o={provide:(i,c)=>((t==="multiProvide"||!e[i])&&(e[i]=c),o),resolve:i=>e[i]};return o},_={a:["\xE0","\xE2"],e:["\xE9","\xEA","\xE8","\xEB"],i:["\xEE","\xEF"],o:["\xF4"],u:["\xF9","\xFB","\xFC"],c:["\xE7"]},N=(e,t,n)=>{for(const s of e){const o=s.indexOf(t);if(o!==-1){if(n==="next")return o===s.length-1?s[0]:s[o+1];if(n==="previous")return o===0?s[s.length-1]:s[o-1]}}return t},q=(()=>{const e=Object.entries(_).map(t=>[t[0],...t[1]]);return{get:(t,n)=>N(e,t,n)}})();function b(){return e=>{}}const j=String.fromCharCode(8204),y=p({name:"Label",props:{text:String,for:{type:String,required:!0},marginSide:{type:String,required:!0}},setup(e){const t=f(()=>({[`margin-${e.marginSide}`]:e.text?"1ch":void 0}));return()=>a("label",{for:e.for,"aria-hidden":!e.text,style:t.value},[e.text])}}),D=p({name:"Challenge",components:{Label:y},props:{challenge:{type:Object,required:!0},stateColor:String,stateTransitionTime:Number},emits:{attempt:b(),skip:b()},setup(e,{emit:t}){const n=f(()=>{var l,r;return{fontSize:"1.75em",padding:"0.25em",marginBottom:"0.25em",borderRadius:"0.2em",border:"0.075em solid transparent",transition:`border-color ease-in-out ${((l=e==null?void 0:e.stateTransitionTime)!=null?l:0)/1e3}s`,borderColor:(r=e.stateColor)!=null?r:"transparent"}}),s=v(""),o="challenge-input",i=f(()=>{var l,r,u,m,h;return Math.max((r=(l=e.challenge)==null?void 0:l.answerLength)!=null?r:0,(h=(m=(u=e.challenge)==null?void 0:u.hint)==null?void 0:m.length)!=null?h:0)}),c=f(()=>({border:"none",outline:"none",backgroundColor:"transparent",width:`${i.value}ch`}));k(()=>e.challenge,()=>s.value="");const g={" ":l=>l.preventDefault(),Enter:()=>t("attempt",s.value),Tab:l=>{l.preventDefault();const[r,u]=[l.target.selectionStart,l.target.selectionEnd],m=r-1,h=s.value[m];!h||(s.value=s.value.slice(0,m)+q.get(h,l.shiftKey?"previous":"next")+s.value.slice(m+1),L(()=>l.target.setSelectionRange(r,u)))},Escape:()=>t("skip")},d=l=>{var r;return(r=g[l.key])==null?void 0:r.call(g,l)};return()=>{var l,r,u;return a("div",{style:{textAlign:"center"}},[a("div",{style:n.value},[a(y,{text:(l=e.challenge)==null?void 0:l.pre,for:o,marginSide:"right"},null),R(a("input",{"onUpdate:modelValue":m=>s.value=m,id:o,placeholder:(r=e.challenge)==null?void 0:r.hint,maxlength:i.value,style:c.value,onKeydown:d,spellcheck:"false"},null),[[w,s.value]]),a(y,{text:(u=e.challenge)==null?void 0:u.post,for:o,marginSide:"left"},null)]),a("div",null,[e.challenge.context?`(${e.challenge.context})`:j])])}}}),F=3,M=p({name:"ChallengePanel",props:{container:{type:Object,required:!0}},setup:e=>{const t=e.container.resolve("messenger");if(!t)return;const n=I([]),s=250,o=v(void 0),i=r=>{o.value=r,setTimeout(()=>o.value=void 0,s)},c=(r=1)=>{for(let u=0;u<r;++u)t.publish({name:"newChallenge",message:{}})},g=f(()=>n[0]),d=r=>t.publish({name:"attempt",message:{challengeId:g.value.challengeId,attempt:r}}),l=r=>{i({correct:"green",close:"orange",incorrect:"red",skip:"red"}[r]),!(r==="incorrect"||r==="close")&&(r==="skip"&&t.publish({name:"skip",message:{challengeId:g.value.challengeId}}),n.shift(),c())};return t.subscribe("newChallenge",({message:r})=>n.push(r)).subscribe("attempt",({message:r})=>l(r.result)).subscribe("skip",({message:r})=>alert(r.answer)),c(F),()=>a("div",null,[g.value?a(D,{challenge:g.value,stateColor:o.value,stateTransitionTime:s,onAttempt:d,onSkip:()=>l("skip")},null):"No words found \u{1F914}"])}}),B={topRight:(e,t)=>{const n=e==="parent"?"%":"vw",s=`translate(calc(-1 * (100% + ${t})), ${t})`;return{top:"0",left:`100${n}`,transform:s}}},K=({corner:e,relativeTo:t,offset:n="0"})=>x({position:"absolute"},B[e](t,n)),H=p({name:"Cornered",props:{content:{type:Object,required:!0},cornerStyle:{type:Object,required:!0}},emits:{click:b()},setup:(e,{emit:t})=>()=>a("div",{style:K(e.cornerStyle),onClick:()=>t("click")},[e.content])}),J=p({name:"SettingsPanel",setup:()=>()=>a("div",null,[V("Settings")])}),U=p({name:"App",props:{container:{type:Object,required:!0}},setup:e=>{const t=v(!1),n=a("div",{style:{cursor:"pointer"}},[t.value?"\u270F\uFE0F":"\u2699\uFE0F"]);return()=>a("div",null,[a(H,{content:n,cornerStyle:{corner:"topRight",relativeTo:"viewport",offset:"33%"},onClick:()=>t.value=!t.value},null),a("div",{class:"page content-center"},[t.value?a(J,null,null):a(M,{container:e.container},null)])])}}),W=(e,t)=>{!t||(t("Connection established."),e.addEventListener("message",()=>t("Message received.")),e.addEventListener("error",n=>t(`Error occurred, ${n}.`,"bad")),e.addEventListener("close",()=>t("Connection closed.")))},z=(e,t,n)=>{var g;const s=new WebSocket(`ws://${e}:${t}`),o=(g=n.resolve("logger"))!=null?g:()=>{};W(s,o);const i={newChallenge:[],attempt:[],skip:[]},c={publish:d=>{var r;const l=JSON.stringify(d);return(r=n.resolve("logger"))==null||r(`Sending ${l}`),s.send(l),c},subscribe:(d,l)=>(i[d].push(l),c)};return s.addEventListener("message",({data:d})=>{var r;(r=n.resolve("logger"))==null||r(`Recieved ${d}`);const l=JSON.parse(d);i[l.name].forEach(u=>u(l))}),new Promise(d=>s.addEventListener("open",()=>d(c)))},G=async()=>{const e=A({}),{VITE_SERVER_HOST:t,VITE_SERVER_PORT:n}={VITE_SERVER_HOST:"TODO",VITE_SERVER_PORT:"443",BASE_URL:"/language-revisor/",MODE:"production",DEV:!1,PROD:!0};e.provide("messenger",await z(t,parseInt(n),e)),P(U,{container:e}).mount("#app")};G();
